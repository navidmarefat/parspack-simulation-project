(window.webpackJsonp=window.webpackJsonp||[]).push([["initiate"],{131:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.initInitiateChat=e.updateInitiateStatus=e.openInitiateChatTab=e.openInitiateChat=e.hideInitiateChat=void 0,a(96);var i=a(64);function n(t,e){if(i.app.length){i.opts.chatstate.waiting&&!i.app.is(".connected")&&i.app.add(i.container).addClass("connecting");var n=i.opts.introduction;e&&(n=e);var s=i.app.find(".scroll .initiate.chat");if(!i.opts.popup&&n&&s.length&&!s.find(".message .content").length){var d=s.find(".message");i.opts.messageBubbles&&d.addClass("bubble left"),a.e("messages").then(a.t.bind(null,132,7)).then(function(t){t.replaceMessageContent(n).then(function(t){var e='<div class="content">'+t+"</div>";d.html(e),s.addClass("active")})})}i.settings.embeddedinitiate&&i.settings.embeddedinitiate.id>0&&!i.opts.accepted&&i.showOperatorDetails(i.settings.embeddedinitiate,!t)}}function s(e,a,n){var s="url('"+n+"')",d=".initiate.chat .avatar";t("<img />").one("error",function(){t(this).remove(),s="url('"+i.opts.server+i.apiPath+i.apiEndpoint.image+"?size=150&round=true')";var n=e.find(".operator.photo");n.is(".alert")||n.css("background-image",s),(i.opts.chatstate.idle||i.opts.chatstate.waiting||i.opts.chatstate.completed)&&i.app.find(d).css("background-image",s),a||r(e)}).one("load",function(){t(this).remove();var n=e.find(".operator.photo");n.is(".alert")||n.css("background-image",s),(i.opts.chatstate.idle||i.opts.chatstate.waiting||i.opts.chatstate.completed)&&i.app.find(d).css("background-image",s),a||r(e)}).attr("src",n)}
var d=function(t){return function(e){var a=i.initiatechat.is(".offline"),n=i.initiatechat.is(".message");t&&(e&&e.stopPropagation(),a||n||p(-3)),a&&t?i.toggleOfflineChat():i.app.is(".feedback")||t?i.closeFeedback():a||
        (
            /*20210809s*/doConsoleLog('init hideInitiateChat(...) '),/*2021e*/
            c(i.initiatechat)
        ,i.opts.embedded?(
        /*20210809s*/doConsoleLog('init is core.opts.embedded : remvin initopn'),/*2021e*/
            l()
        ,i.initiatechat.removeClass("opened")
        ,i.container.removeClass("initiate-opened")):(
        /*20210809s*/doConsoleLog('init not core.opts.embedded '),/*2021e*/
            openLiveHelp(),p(-1)))}};function o(t){/*2021s*/doConsoleLog('showInitiateChat');/*2021e*/t.is(".opened")||(i.chatbutton.add(i.chatbuttonframe).addClass("initiate"),t.addClass("opened").removeClass("hidden")
        ,i.container.addClass("initiate-opened"),i.messageSound&&i.storage.data.soundEnabled&&i.playInitiateChatSound())}
        var c=function(t){
            /*20210809s*/doConsoleLog('init hideInitiateChat  is open?',t.is(".opened"));/*2021e*/
                t.is(".opened")&&(i.chatbutton.add(i.chatbuttonframe).removeClass("initiate"),t.removeClass("opened").addClass("hidden"),i.container.removeClass("initiate-opened"))};e.hideInitiateChat=c;
                var r=function(t){
                    /*20210810s*/doConsoleLog('openInitiateChat...');/*2021e*/
                    var e=a(64);if(t.find(".bubble, .feedback").on("click",function(t){if(e.app.is(".feedback"))return t.preventDefault(),!1})
                        ,t.find("a").on("click",function(t){t.stopPropagation()}),t.on("click",d(!1)),t.find(".close").on("click",d(!0))
                        ,t.find(".feedback textarea").on("keypress",function(t){return 13!==t.which||(g(),!1)})
                        ,t.find(".brand").on("click",function(t){t.stopPropagation()})
                        ,/*20210810s*/doConsoleLog('openInitiateChat isopen?',e.app.is(".opened"))/*2021e*/
                        ,!e.app.is(".opened")){var i=t.is(".message");
                        /*20210810s*/doConsoleLog('openInitiateChat ismsg?',i)/*2021e*/;
                        i&&o(t);var n=e.initiatechat.find(".bubble"),s=10,r=-(n.height()+parseInt(n.css("margin-top"),10)+parseInt(n.css("margin-bottom"),10)+parseInt(e.initiatechat.css("padding-top"),10)+parseInt(e.initiatechat.css("padding-bottom"),10)+s),l=e.initiatechat.find(".bubble").outerHeight()-60,p=l+95,u="true"===t.attr("data-collapsed");e.storage.data.feedbackOpen||"Online"===e.settings.status||i||(s="-"+(parseInt(t.find(".bubble").outerHeight(),10)+parseInt(t.find(".bubble").css("margin-top"),10))+"px",l=t.css("height")+"px",u=!0,t.is(".offline")?s=0:t.find(".close").hide()),t.is(".offline")&&(l="auto",p=!1),t.find(".bubble").css({bottom:s,height:"auto"}),p&&e.chatbuttonframe.css("height",p+"px"),t.attr("data-collapsed",u),"auto"!==l?(l=l+70+"px",t.css({height:l})):t.css({height:l})
                            ,e.opts.chatstate.connected?(i?(r=0,o(t)):(/*20210810s*/doConsoleLog('openInitiateChat goingtohide...',i),/*2021e*/c(t))
                            ,t.css("bottom",r)):e.storage.data.offlineOpen||(/*20210810s*/doConsoleLog('openInitiateChat offline goingtohide...',e.storage.data.offlineOpen),/*2021e*/c(t)),t.is(".offline")||!(e.opts.chatstate.idle||e.opts.chatstate.completed||i)||e.opts.disabled||(e.chatbutton.add(e.container).removeClass("enabled").addClass("disabled"),o(t))
                    }};
                e.openInitiateChat=r;
var l=function(){
    /*20210809s*/doConsoleLog('init opninitcht');/*2021e*/
    /*20210809s*/doConsoleLog('init opninitcht disabled?',i.opts.disabled);/*2021e*/
    /*20210809s*/doConsoleLog('init opninitcht pop?',i.opts.popup);/*2021e*/
    var t=i.app.find(".message.textarea");n();var e="closed";i.opts.disabled&&(e+=" hidden"),i.opts.popup||i.app.add(i.container).removeClass("opened").addClass(e),i.storage.data.operatorDetailsOpen=!0,i.updateStorage(),i.chatbuttonframe.css("height",""),i.openTab(!0).then(function(){window.setTimeout(function(){t.focus()},500)}),p(-1),i.app.addClass("initiate").attr("data-initiate",!0),i.app.attr("data-opened",!0)};

e.openInitiateChatTab=l;var p=function(t,e,a){i.settings.initiate&&i.settings.initiate.status!==t&&(i.settings.initiate.status=t,i.settings.initiate.update=!0,i.visitorInitialised>0&&(i.visitorTimeout=!1,-2!==(t=t||0)&&-3!==t||i.$parent(i.selector+"InitiateChat").hide()
            ,function(t,e,a){var i=Chatstack.initiateChatState;switch(t){case 0:t="idle";break;case-1:t="waiting";break;case-2:t="accepted";break;case-3:t="declined"}
            if(Chatstack.initiateChatState=t,i!==t){var n={state:t};
            e&&(n.message=e),a&&(n.image=a),Chatstack.events.trigger("InitiateChatStateChanged",n)}}(t,e,a),i.updateSettingsTimed(!0)))};
e.updateInitiateStatus=p;
var u=function(e,d,c,r){n(e,c);var l=i.opts.introduction,u=i.initiatechat,g=!(!u.length||"true"!==u.attr("data-collapsed")),h=!1;
if(u.length){c&&(l=c);
var f=u.find(".text.content");!u.length||u.is(".sent")||u.is(".feedback")||i.app.is(".offline")||f.text()===l||f.text(l),r&&(h=r,s(u,!1,r)),i.opts.embedded&&!i.chatbutton.is(":visible")&&g&&o(u),e&&p(-1,l,h)
}else{
    var v=i.settings.embeddedinitiate;v.id>0&&(h="https://newchat.parspack.com/livehelp/images/avatar.png"),i.settings.images.initiatechat&&i.settings.images.initiatechat.length&&(h=i.settings.images.initiatechat),r&&(h=r),c&&(l=c),i.app.is(".offline")&&(l=i.settings.language.offlinemessagedescription),t.isArray(i.opts.feedback)&&i.opts.feedback.length&&"Online"!==i.settings.status&&(i.opts.feedback.sort(
        function(){return Math.round(Math.random())-.5}),l=i.opts.feedback[0]);
    var m=[{css:"good",title:i.settings.language.good,rating:3},{css:"poor",title:i.settings.language.poor,rating:1}];m.sort(
        function(){return Math.round(Math.random())-.5});var b="";i.app.is(".offline")&&(b="offline");
        var k='<div class="'+i.namespace+"-initiate-chat "+b+'" data-collapsed="false"> <div class="message bubble right"> <div class="tab"> <div class="title">'+i.settings.language.offlinemessagetitle+'</div> <div class="text content">'+l+'</div> </div> <div class="intro">'+i.settings.language.feedbackintroduction+'</div> <div class="text content">'+l+'</div> <div class="feedback"> <input class="email input" type="text" tabindex="100" placeholder="'+i.settings.language.enteryourfeedbackemail+'"/> <textarea class="message input" type="text" tabindex="200" placeholder="'+i.settings.language.enteryourfeedback+'"></textarea> <div class="needsupport hidden">'+i.settings.language.needsupport+'  <a href="#" target="_blank">'+i.settings.language.clickhere+'</a></div> <div class="rating container">   <div class="rating '+m[0].css+'" title="'+m[0].title+'" data-rating="'+m[0].rating+'"></div>   <div class="rating neutral" title="'+i.settings.language.neutral+'" data-rating="2"></div>   <div class="rating '+m[1].css+'" title="'+m[1].title+'" data-rating="'+m[1].rating+'"></div> </div> </div> <div class="offline"> <form id="OfflineMessageForm" method="post" class="form">   <div>     <input class="name input" type="text" autocomplete="name" tabindex="100" placeholder="'+i.settings.language.enteryourofflinename+'"/>     <div class="name error sprite TickSmall" title="Name Required" class=""></div>   </div>   <div>     <input class="email input" type="text" autocomplete="email" tabindex="200" placeholder="'+i.settings.language.enteryourofflineemail+'"/>     <div class="email error sprite TickSmall" title="Email Required"></div>   </div>   <input class="website input" type="text" autocomplete="none" tabindex="400"/>   <div>     <textarea class="message input" type="text" tabindex="300" placeholder="'+i.settings.language.enteryourofflinemessage+'"></textarea>     <div class="message error sprite TickSmall" title="Message Required"></div>   </div>   <div class="securitycode">     <label class="label">'+i.settings.language.securitycode+'</label>     <div class="content">       <input class="security input" data-index="1" type="text" autocomplete="email" maxlength="1" tabindex="300"/>       <input class="security input" data-index="2" type="text" autocomplete="email" maxlength="1" tabindex="305"/>       <input class="security input" data-index="3" type="text" autocomplete="email" maxlength="1" tabindex="310"/>       <input class="security input" data-index="4" type="text" autocomplete="email" maxlength="1" tabindex="315"/>       <div class="code"></div>       <div class="loading-inner ball-clip-rotate">         <div></div>       </div>       <div class="refresh button">         <div class="refresh icon light"></div>       </div>     </div>     <div class="security error sprite TickSmall" title="Email Required"></div>   </div> </form> <div class="sending">   <div class="loading-inner ball-clip-rotate">     <div></div>   </div>   <div class="text">Sending</div> </div> </div> <a href="https://www.chatstack.com" target="_blank" class="brand"><div class="icon"></div></a> </div> <div class="operator photo"></div> <div class="operator badge">1</div> <div class="close" title="'+i.settings.language.close+'"><span class="icon">&#10005;</span><span class="text">'+i.settings.language.close+"</span></div> </div>",x=i.chatbutton.closest("#"+i.namespace+"-container");i.initiatechat=t(k).appendTo(x),i.settings.rtl&&i.initiatechat.addClass("rtl");
        var C=i.initiatechat.find(".brand");if(a.e("brand").then(a.t.bind(null,135,7)).then(
            function(t){C.find(".icon").html(t.default)}),i.settings.language.copyright.length&&C.add(u).addClass("copyright"),i.settings.captcha&&i.settings.captcha.code){i.initiatechat.add(i.chatbuttonframe).addClass("security");var y=i.initiatechat.find(".securitycode .code");!y.find("svg").length&&i.settings.captcha&&i.settings.captcha.image&&y.attr("data-captcha",i.settings.captcha.code).html(i.settings.captcha.image),i.initiatechat.find(".securitycode .refresh.button").on("click",function(){var e=t(this).closest(".securitycode");e.addClass("loading"),i.updateSettingsTimed().then(function(){e.find(".code").attr("data-captcha",i.settings.captcha.code).html(i.settings.captcha.image),e.removeClass("loading")})})}i.initiatechat.find(".offline .email.input, .offline .message.input").on("change keyup input focus blur",function(){i.toggleOfflineSendButton()}),i.initiatechat.find(".offline .security.input").on("keydown",function(e){var a=t(this).val(),n=parseInt(t(this).attr("data-index"),10);9!=e.keyCode&&(a.length?8==e.keyCode?(t(this).val(""),e.preventDefault()):(n+=1,i.initiatechat.find('.offline .security.input[data-index="'+n+'"]').focus()):8==e.keyCode&&(n-=1,i.initiatechat.find('.offline .security.input[data-index="'+n+'"]').val("").focus(),e.preventDefault()))}),i.initiatechat.find(".offline .security.input").on("keyup",function(e){var a=t(this).val(),n=parseInt(t(this).attr("data-index"),10);a.length&&8!==e.keyCode&&9!==e.keyCode&&(n+=1),i.initiatechat.find('.offline .security.input[data-index="'+n+'"]').focus()});var w=!1;if(i.app.is(".feedback")){i.initiatechat.addClass("feedback rating"),w=!0,i.settings.images.feedback&&i.settings.images.feedback.length&&(h=i.settings.images.feedback);
            var I=!1;if(i.settings.supportaddress.length&&(-1!==i.settings.supportaddress.indexOf("https://")||-1!==i.settings.supportaddress.indexOf("http://"))){var S=i.initiatechat.find(".needsupport");I=!0,S.find("a").attr("href",i.settings.supportaddress),S.removeClass("hidden")}(m=i.$parent(".rating.container")).find(".rating").on("click",
            function(){var e=t(this),a="neutral",n="How can we improve?";switch(parseInt(t(this).attr("data-rating"),10)){case 1:a="poor",n="Sorry to hear that.  Please let us know how we can improve.";break;case 3:a="good",n="That's great!  Please let us know if you have any feedback."}e.parent().find('.rating[data-rating!=" + score + "]').addClass("deselected"),e.removeClass("deselected"),i.initiatechat.removeClass("rating").addClass(a);
            var s="223px";I&&(s="241px"),i.initiatechat.css("height",s),e=i.initiatechat.find(".text.content"),i.initiatechat.attr("data-question",e.text()),i.initiatechat.find(".text.content").text(n)})}else i.initiatechat.removeClass("feedback"),!e&&b||p(-1,l,h);t(i.documents.js).trigger(i.prefix+".InitiateChatLoaded")
            ,s(i.initiatechat,w,h)
            ,/*20210809s*/doConsoleLog('init going to close hidden app',e,!i.opts.popup)/*2021e*/
            ,e&&!i.opts.popup&&i.app.add(i.container).removeClass("opened").addClass("closed hidden")
}};function g(){var e=i.initiatechat,a=e.find("input"),n=e.find("textarea"),s=e.find(".text.content"),d=e.attr("data-question"),o=parseInt(i.$parent(".rating.container .rating.option:not(.deselected)").attr("data-rating"),10),c={QUESTION:d,EMAIL:a.val(),MESSAGE:n.val(),SCORE:o,SESSION:i.cookies.session,JSON:!0};t.ajax({url:i.opts.server+i.apiPath+i.apiEndpoint.feedback,data:t.param(c),success:function(t){if(t.result&&!0===t.result){s.text("Thanks for the feedback!"),e.find(".feedback input, .feedback textarea").hide();var a=e.find(".bubble").outerHeight()+25+"px";e.css({height:a}),i.storage.store.set("feedback",!0)}},dataType:"jsonp",cache:!1,xhrFields:{withCredentials:!0}})}e.initInitiateChat=u;e.default=function(e,a,n,s){var d=function(e,a,n){i.opts.initiate&&(void 0!==i.settings.status&&"Online"===i.settings.status||void 0!==e)&&void 0!==i.settings.embeddedinitiate&&null!=i.settings.embeddedinitiate&&(i.app.is(".closed")||i.app.is(".hidden"))&&i.opts.visitorTracking&&!t.data(i.app,"initiate")&&-3!==i.settings.initiate.status&&u(!0,0,a,n)};i.opts.initiateDelay>0&&!e?window.setTimeout(function(){d(a,n,s)},i.opts.initiateDelay):d(a,n,s)}}).call(this,a(61))}}]);
function doConsoleLog(){
    return;
}
